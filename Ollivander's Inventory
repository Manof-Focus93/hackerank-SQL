SELECT
    W.ID,
    WP.AGE,
    W.COINS_NEEDED,
    W.POWER
FROM WANDS W
INNER JOIN WANDS_PROPERTY WP ON W.CODE = WP.CODE
WHERE WP.IS_EVIL = 0
AND W.COINS_NEEDED = (SELECT MIN(COINS_NEEDED) FROM WANDS
                      WHERE CODE = W.CODE
                      AND POWER = W.POWER)
ORDER BY W.POWER DESC, WP.AGE DESC;
